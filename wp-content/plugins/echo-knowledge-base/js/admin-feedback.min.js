!function(e){"use strict";var a={cacheElements:function(){this.cache={$deactivateLink:e("#the-list").find('[data-slug="echo-knowledge-base"] span.deactivate a'),$dialogHeader:e("#epkb-deactivate-feedback-dialog-header"),$dialogForm:e("#epkb-deactivate-feedback-dialog-form")}},bindEvents:function(){var e=this;e.cache.$deactivateLink.on("click",function(a){a.preventDefault(),e.getModal().show()})},deactivate:function(){location.href=this.cache.$deactivateLink.attr("href")},initModal:function(){var a,t=this;t.getModal=function(){if(!a){var i=new EPKBDialogsManager.Instance;a=i.createWidget("lightbox",{id:"epkb-deactivate-feedback-modal",headerMessage:t.cache.$dialogHeader,classes:{globalPrefix:"epkb-dialog"},message:t.cache.$dialogForm,hide:{onButtonClick:!1},position:{my:"center",at:"center"},onReady:function(){EPKBDialogsManager.getWidgetType("lightbox").prototype.onReady.apply(this,arguments),this.addButton({name:"submit",text:"Submit & Deactivate",callback:function(){e('.epkb-deactivate-feedback-dialog-input-wrapper input[name="reason_key"]:checked').length?(jQuery("#epkb-deactivate-feedback-dialog-form-error").hide(),t.sendFeedback()):jQuery("#epkb-deactivate-feedback-dialog-form-error").show()}}),this.addButton({name:"skip",text:"Skip & Deactivate",callback:function(){t.deactivate()}})},onShow:function(){var a=e("#epkb-deactivate-feedback-modal");a.find(".epkb-deactivate-feedback-dialog-input").on("change",function(){a.attr("data-feedback-selected",e(this).val())}),a.find(".epkb-deactivate-feedback-dialog-input:checked").trigger("change")}})}return a}},sendFeedback:function(){var a=this.cache.$dialogForm.serialize();this.getModal().getElements("submit").text("").addClass("epkb-loading"),e.post(ajaxurl,a,this.deactivate.bind(this))},init:function(){this.initModal(),this.cacheElements(),this.bindEvents()}};e(function(){a.init()})}(jQuery);