jQuery(document).ready(function(e){function o(o,n){if("show"===o){let o='<div class="epkb-admin-dialog-box-loading"><div class="epkb-admin-dbl__header"><div class="epkb-admin-dbl-icon epkbfa epkbfa-hourglass-half"></div>'+(n?'<div class="epkb-admin-text">'+n+"</div>":"")+'</div></div><div class="epkb-admin-dialog-box-overlay"></div>';e("body").append(o)}else"remove"===o&&(e(".epkb-admin-dialog-box-loading").remove(),e(".epkb-admin-dialog-box-overlay").remove())}function n(e,o,n){return'<div class="eckb-bottom-notice-message"><div class="contents"><span class="'+n+'">'+(e?"<h4>"+e+"</h4>":"")+(o||"")+"</span></div></div>"}let i=e("#epkb-config-wizard-content");if(i.length<=0)return;let a=e(".epkb-admin__error-form__container");i.find(".epkb-setup-wizard-button-apply").on("click",function(i){let r=[],t={action:"epkb_help_dialog_apply_setup_wizard_changes",_wpnonce_apply_wizard_changes:e("#_wpnonce_apply_wizard_changes").val(),epkb_wizard_kb_id:e("#epkb_wizard_kb_id").val()},s=e('input[name="epkp-theme"]:checked').val();void 0===s&&(s="standard"),e(".epkb-menu-checkbox input[type=checkbox]:checked").length&&e(".epkb-menu-checkbox input[type=checkbox]:checked").each(function(){r.push(e(this).prop("name").split("epkb_menu_")[1])}),t.theme_name=s,t.kb_name=e(".epkb-wizard-name input").val(),t.kb_slug=e(".epkb-wizard-slug input").val(),t.menu_ids=r,function(i,r,t,s,d=!1){let p,c;r=void 0===r?"epkb_callback_noop":r,e.ajax({type:"POST",dataType:"json",data:i,url:ajaxurl,beforeSend:function(e){d||o("show",s)}}).done(function(e){(c=e||"").error||void 0===c.message?p=c.message?c.message:n("",epkb_vars.reload_try_again,"error"):c.redirect_to_url&&c.redirect_to_url.length>0&&setTimeout(function(){window.location=c.redirect_to_url},2e3)}).fail(function(e,o,i){p=i?" ["+i+"]":epkb_vars.unknown_error,p=n(epkb_vars.error_occurred+". "+epkb_vars.msg_try_again,p,"error")}).always(function(){d||o("remove",""),p?(e(a).find(".epkb-admin__error-form__title").text(epkb_vars.setup_wizard_error_title),e(a).find(".epkb-admin__error-form__desc").text(epkb_vars.setup_wizard_error_desc),e(a).find("#epkb-admin__error-form__message").val(e(p).text().trim()),e(a).css("display","block","important")):(d||c.error||void 0===c.message||e(".eckb-bottom-notice-message").replaceWith(n("",c.message,"success")),"function"==typeof r?r(c=void 0===c?"":c):t&&location.reload())})}(t,function(o){e(".epkb-wizard-button-container").hide()},!1,epkb_vars.save_config)}),e(".epkb-setup-option__option__label").on("click",function(){e(".epkb-setup-option-container").removeClass("epkb-setup-option-container--active"),e(this).closest(".epkb-setup-option-container").addClass("epkb-setup-option-container--active")}),i.find(".epkb-setup-option__featured-img-container").on("click",function(o){o.preventDefault(),o.stopPropagation(),i.find(".image_zoom").remove();var n,a=e(this).find("img");n=a.length>1?e(a[0]).is(":visible")?e(a[0]).attr("src"):e(a[1]).is(":visible")?e(a[1]).attr("src"):e(a[2]).attr("src"):e(this).find("img").attr("src"),e(this).after('<div id="epkb_image_zoom" class="image_zoom"><img src="'+n+'" class="image_zoom"><span class="close epkbfa epkbfa-close"></span></div>'),e("html, body").on("click",function(){e("#epkb_image_zoom").remove(),e("html, body").off("click")})}),e(document).on("click",".epkb-close-notice",function(){e(this).parent().addClass("fadeOutDown")}),e(a).on("click",".epkb-close-notice, .epkb-admin__error-form__btn-cancel",function(){window.location=epkb_vars.need_help_url}),e(a).find("#epkb-admin__error-form").on("submit",function(o){o.preventDefault();let n=e(this);o.data;e.ajax({type:"POST",dataType:"json",url:ajaxurl,data:n.serialize(),beforeSend:function(o){e(a).find("input, textarea").prop("disabled","disabled"),e(a).find(".epkb-admin__error-form__response").html(epkb_vars.sending_error_report)}}).done(function(o){void 0!==o.success&&0==o.success?e(a).find(".epkb-admin__error-form__response").html(o.data):void 0!==o.success&&1==o.success?e(a).find(".epkb-admin__error-form__response").html(o.data):e(a).find(".epkb-admin__error-form__response").html(epkb_vars.send_report_error)}).fail(function(o,n,i){e(a).find(".epkb-admin__error-form__response").html(epkb_vars.send_report_error)}).always(function(){e(a).find("input, textarea").prop("disabled",!1),setTimeout(function(){window.location=epkb_vars.need_help_url},1e3)})})});